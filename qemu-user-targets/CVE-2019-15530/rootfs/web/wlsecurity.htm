<html>
<! Copyright (c) Realtek Semiconductor Corp., 2007. All Rights Reserved. ->
<head>
<meta http-equiv="Content-Type" content="text/html">
<% getIndex("no-cache"); %>
<title>Wireless Security Setup</title>
<script type="text/javascript" src="util_gw.js"> </script>
<% getInfo("include_css"); %>
<style>
.on {display:on}
.off {display:none}	
</style>
<script>
SecurityTypePage = new Array("wlsecurity_all.htm");
var defPskLen=new Array();
var defPskFormat=new Array();
var autoconf=new Array();
var wlan_idx=<% getIndex("wlan_idx"); %>;
var wlan_mode = <% getIndex("wlanMode");%>;
autoconf[wlan_idx]= 0;
var SSIDnum = 1;
var wlProfileSupport="<% getInfo("wlProfileSupport"); %>"*1;

function ValidateForm(passForm, reset)
{
	var question;

	if (reset) {
		passForm.reset();				
		var auth = get_by_id("SSIDAuthMode");
		auth.src = SecurityTypePage[0];
	}
	else {
		if (self.SSIDAuthMode.ValidateForm(passForm) == true) {
			 if ((passForm.method<% getIndex("wlan_idx"); %>.value == 7) && (passForm.wapiAuth<% getIndex("wlan_idx"); %>[0].checked)){
			 	// For wapi-cert only
				 question = confirm("Note: if you choose [Enterprise (AS Server)] and apply changes here, \nthis wlan interface and its virtual interfaces will use the current AS setting.\nDo you want to continue?");
			        if(!question)
			        {
			                return;
			        }
			 }
			passForm.submit();
		}
	}
}

function SetSSIDSettingOption()
{	
	var mode = <% getIndex("wlanMode");%>;
	var mssid_num=<%getIndex("wlan_mssid_num");%>;
	var rp_enable = <% getIndex("repeaterEnabled"); %>;
	var wlEnableProfile="<%getInfo("wlEnableProfile");%>"*1;
	var wlProfile_num="<%getInfo("wlan_profile_num");%>"*1;
	
	if (mode != 1) {	
		var ssid="<% getInfo("ssid"); %>";
		var val="Root AP - " + ssid;
		if(mode != 5) {/*MESH mode do not have ROOT AP option*/
			var disable=new Array()
			disable[0] = 0;		
			disable[1] = <% getVirtualIndex("wlanDisabled", "1"); %>;
			disable[2] = <% getVirtualIndex("wlanDisabled", "2"); %>;
			disable[3] = <% getVirtualIndex("wlanDisabled", "3"); %>;
			disable[4] = <% getVirtualIndex("wlanDisabled", "4"); %>;
			
			for (i=0; i<=mssid_num; i++) {	
				if (!disable[i]) {
					document.write("<option value=\"" + i + "\"><font face=\"Arial\" style=\"font-size: 8pt\">");
					document.write(val);
					document.write("</font></option>");
				}
				if (i != 4 && !disable[i+1]) {
					id =  i+1;
					if (id == 1)	
						ssid =  " - <% getVirtualInfo("ssid", "1"); %>";
					else if (id == 2)	
						ssid =  " - <% getVirtualInfo("ssid", "2"); %>";
					else if (id == 3)	
						ssid =  " - <% getVirtualInfo("ssid", "3"); %>";
					else
					ssid =  " - <% getVirtualInfo("ssid", "4"); %>";	
					val = "AP" + id + ssid;
				}		
			}
		}
		
		var is_adhoc = <% getIndex("networkType"); %>;
		if (rp_enable==1 && ((mode == 0 || mode == 3 || mode == 4 || mode == 5) || (mode == 1 && !is_adhoc)) 
			&& (wlEnableProfile == 0 || wlProfile_num == 0)
		) 
		{
			ssid =  " - <% getInfo("repeaterSSID"); %>";
			if (mode == 1)
				val = "Repeater AP" + ssid;
			else
				val = "Repeater Client" + ssid;
			document.write("<option value=5><font face=\"Arial\" style=\"font-size: 8pt\">");
			document.write(val);
			document.write("</font></option>");			
		}	
	}
	else { // client mode has no vxd interface 
		if(wlEnableProfile == 0 || wlProfile_num == 0)
		{

			var ssid="Root Client - " + "<% getInfo("ssid"); %>";
			document.write("<option value=0><font face=\"Arial\" style=\"font-size: 8pt\">");
			document.write(ssid);
			document.write("</font></option>");		
		}
		
			
	}	
	
	
	var wlProfileEnable=new Array();
	var wlProfileSSID=new Array();
	
	wlProfileEnable[0]="<% getWlProfileInfo("wlProfileTblEnable", "1"); %>"*1;
	wlProfileEnable[1]="<% getWlProfileInfo("wlProfileTblEnable", "2"); %>"*1;
	wlProfileEnable[2]="<% getWlProfileInfo("wlProfileTblEnable", "3"); %>"*1;
	wlProfileEnable[3]="<% getWlProfileInfo("wlProfileTblEnable", "4"); %>"*1;
	wlProfileEnable[4]="<% getWlProfileInfo("wlProfileTblEnable", "5"); %>"*1;
	
	wlProfileSSID[0]="<% getWlProfileInfo("wlProfileSSID", "1"); %>"
	wlProfileSSID[1]="<% getWlProfileInfo("wlProfileSSID", "2"); %>"
	wlProfileSSID[2]="<% getWlProfileInfo("wlProfileSSID", "3"); %>"
	wlProfileSSID[3]="<% getWlProfileInfo("wlProfileSSID", "4"); %>"
	wlProfileSSID[4]="<% getWlProfileInfo("wlProfileSSID", "5"); %>"
	
	if(wlProfileSupport == 1)
	{
		if((rp_enable == 1 && (mode == 0 || mode == 3)) //0:AP 3:AP+WDS
			|| (mode == 1) //1:Client
		) 
		{
			var wlProfile_start = "<%getIndex("wlan_root_mssid_rpt_num");%>"*1;
		

		
			for (i=0; i<=wlProfile_num; i++, wlProfile_start++) 
			{				
				if (wlProfileEnable[i]) {
					if(mode == 1) {//client
						var ssid="AP Profile - " + wlProfileSSID[i];
						document.write("<option value=\"" + 0 + "\"><font face=\"Arial\" style=\"font-size: 8pt\">");

					}
					else
					{
						var ssid="Repeater Profile - " + wlProfileSSID[i];
						document.write("<option value=\"" + wlProfile_start + "\"><font face=\"Arial\" style=\"font-size: 8pt\">");
					}
					document.write(ssid);
					document.write("</font></option>");
				}

			}
		}
	}
	
	

	var select=<% getIndex("mssid_idx"); %>;
	document.formEncrypt.SSID_Setting.selectedIndex = select;	
}
//add for mesh 
function apModeCheck()
{
	var disable = 0;
	if(wlan_mode==7)
		disable = 1;
	else if(wlan_mode == 5) {/*MESH mode*/
		var rp_enable = <% getIndex("repeaterEnabled"); %>;
		if(rp_enable == 0) /*if repeater is disable*/
			disable = 1;			
	}

	if(disable)
	{
		disableRadioGroup(document.formEncrypt.SSID_Setting);
		disableButton(document.formEncrypt.save);
		disableButton(document.formEncrypt.reset1);
	}
}

function SSIDSelected(index)
{
	var enable = 1;
	if(wlan_mode == 7) {
		enable = 0;
	}
	else if(wlan_mode == 5) { /*MESH mode*/
		var rp_enable = <% getIndex("repeaterEnabled"); %>;
		if(rp_enable == 0) /*if repeater is disable*/
			enable = 0;	
	}


	if(enable) {
		var auth = get_by_id("SSIDAuthMode");
		auth.src = SecurityTypePage[0];
	}
}

</script>

</head>

<body onload="SSIDSelected();">
<blockquote>
<h2>
	<script type="text/javascript">
		var wlan_num = <% getIndex("wlan_num"); %>;
		if (wlan_num > "1") {
			var wlan_idx_ = <% getIndex("wlan_idx"); %> + 1;
			document.write("Wireless Security Setup -wlan"+ wlan_idx_ + "</p>");
		}
		else
			document.write("Wireless Security Setup</p>");
	</script>
</h2>

<form action=/boafrm/formWlEncrypt method=POST name="formEncrypt">
<table border=0 width="540" cellspacing=4 cellpadding=0>
    <tr><font size=2>
    This page allows you setup the wireless security. Turn on WEP or WPA by using
    Encryption Keys could prevent any unauthorized access to your wireless network.
    </tr>
    <tr><hr size=1 noshade align=top></tr>
<table width="540" height="25" border="0" cellpadding="0" cellspacing="0">
<tr> 
<td  height="20" class="MainTD"><font size="2"><b>Select SSID:&nbsp;&nbsp;</b>
<select name="SSID_Setting" onChange="SSIDSelected( this.selectedIndex )">
<script>SetSSIDSettingOption()</script>
</select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<% getInfo("apply_prompt_comment_start");%>
	 <input type="button" value="Apply Changes" name="save" onClick="ValidateForm(document.formEncrypt, 0);">&nbsp;&nbsp;
	 <input type="button" value="Reset" name="reset1" onClick="ValidateForm(document.formEncrypt, 1);">
<% getInfo("apply_prompt_comment_end");%>
<% getInfo("apply_direct_comment_start");%>
     <input type="hidden" id="save_apply_flag" name="save_apply_flag" value="1">
     <input type="button" value="Save" name="save" onClick="document.getElementById('save_apply_flag').name='save';ValidateForm(document.formEncrypt, 0);">&nbsp;&nbsp;
	 <input type="button" value="Save & Apply" name="save_apply" onClick="document.getElementById('save_apply_flag').name='save_apply';ValidateForm(document.formEncrypt, 0);">&nbsp;&nbsp;
	 <input type="button" value="Reset" name="reset1" onClick="ValidateForm(document.formEncrypt, 1);">
<% getInfo("apply_direct_comment_end");%>
 <script> apModeCheck();	 
</script> 
</td>
</tr>
</table>
<table width="540" height="25" border="0" cellpadding="0" cellspacing="0">
<tr> 
<td  colspan="2" height="20"> 
<hr color="#B5B5E6" size="1">
</td>
</tr>
</table>
<table width="540" border="0" cellpadding="0" cellspacing="0">
<tr> 
<td  rowspan="12" width="540">
<iframe width="540" height="400" id="SSIDAuthMode" name="SSIDAuthMode" frameborder="0" marginheight="0" scrolling="no"> 
</iframe> </td>
</tr>
</table>
</table>

<span id = "wpa_auth" class = "off" >
<table>
<input name="wpaAuth<% getIndex("wlan_idx"); %>" type="radio" value="eap" >PSK
<input name="wpaAuth<% getIndex("wlan_idx"); %>" type="radio" value="psk">Pre-Shared&nbsp;Key
<input type="checkbox" name="ciphersuite<% getIndex("wlan_idx"); %>" value="tkip">TKIP
<input type="checkbox" name="ciphersuite<% getIndex("wlan_idx"); %>" value="aes" >AES
<input type="checkbox" name="wpa2ciphersuite<% getIndex("wlan_idx"); %>" value="tkip">TKIP
<input type="checkbox" name="wpa2ciphersuite<% getIndex("wlan_idx"); %>" value="aes" >AES
<input type="radio" name="wpa11w<% getIndex("wlan_idx"); %>" value="none">none
<input type="radio" name="wpa11w<% getIndex("wlan_idx"); %>" value="capable">capable
<input type="radio" name="wpa11w<% getIndex("wlan_idx"); %>" value="required">required
<input type="radio" name="wpa2EnableSHA256<% getIndex("wlan_idx"); %>" value="disable">disable
<input type="radio" name="wpa2EnableSHA256<% getIndex("wlan_idx"); %>" value="enable">enable
</table>
</span>
<span id= "wapi_auth" class= "off" >
<table>
<input name="wapiAuth<% getIndex("wlan_idx"); %>" type="radio" value="eap" >PSK
<input name="wapiAuth<% getIndex("wlan_idx"); %>" type="radio" value="psk">Pre-Shared&nbsp;Key
</table>
</span>
<input type=hidden name=wps_clear_configure_by_reg<% getIndex("wlan_idx"); %> value=0>
<input type="hidden" id="wlan_ssid" name="wlan_ssid" value="">
<input type="hidden" id="wlan_ssid_id" name="wlan_ssid_id" value="">        
<input type="hidden" id="wlan_security_mode" name="method<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_authtype" name="authType" value="">
<input type="hidden" id="wlan_wepkeylength" name="wepKeyLen<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wepkeyfmt" name="wlan_wepkeyfmt" value="">
<input type="hidden" id="wlan_wepdefaultkey" name="wlan_wepdefaultkey" value="">
<input type="hidden" id="wlan_wepkey" name="wlan_wepkey" value="">

<input type="hidden" id="wepEnabled" name="wepEnabled<% getIndex("wlan_idx"); %>" value="ON">
<input type="hidden" id="length" name="length<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="format" name="format<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="key" name="key<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wpa_psk_fmt" name="pskFormat<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wpa_psk" name="pskValue<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wpa_preAuth" name="preAuth<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_radius_server_ip" name="radiusIP<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_radius_server_port" name="radiusPort<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_radius_server_psk" name="radiusPass<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_ieee8021x" name="use1x<% getIndex("wlan_idx"); %>" value="">

<input type="hidden" id="eap_type" name="eapType<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="eap_inside_type" name="eapInsideType<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="eap_user_id" name="eapUserId<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="radius_user_name" name="radiusUserName<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="radius_user_pass" name="radiusUserPass<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="radius_user_cert_pass" name="radiusUserCertPass<% getIndex("wlan_idx"); %>" value="">

<input type="hidden" id="wlan_wapi_psk_fmt" name="wapiPskFormat<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_wapi_psk" name="wapiPskValue<% getIndex("wlan_idx"); %>" value="">
<input type="hidden" id="wlan_as_server_ip" name="wapiASIP<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" id="wlan_wapi_cert_sel" name="wapiCertSel<% getIndex("wlan_idx"); %>" value="">	
<input type="hidden" value="/wlsecurity.htm" name="submit-url">
</form>
</blockquote>
</body>
</html>
