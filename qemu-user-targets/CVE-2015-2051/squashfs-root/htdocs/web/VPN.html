<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link href="css/jquery.selectbox.css?v=20150211171738" type="text/css" rel="stylesheet"/> <script type="text/javascript" charset="utf-8" src="/js/initialJS.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/initialCSS.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/initialJQ.js?v=20150211171738"></script> <script type="text/javascript" charset="utf-8" src="/js/initialValidate1.js?v=20150211171738"></script> <script>$(document).ready(function(){presetCheckBox("status_vpn",true);$("div.checkbox_on"||"div.checkbox_off").click(function(c){var d=c.target.id+"_ck";if(c.target.getAttribute("class")=="checkbox_on"){var b=I18N("j","Disabled");c.target.setAttribute("class","checkbox_off");c.target.setAttribute("className","checkbox_off");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+" checked>"+b;document.getElementById(d).checked=false;if(d=="status_vpn_ck"){document.getElementById("userName").disabled=true;document.getElementById("password").disabled=true;document.getElementById("psk").disabled=true;document.getElementById("Save_disable_vpn_btn").style.display="block";document.getElementById("Save_vpn_btn").style.display="none";$("#AuthProtocol").selectbox("disable");$("#MPPE").selectbox("disable")}changeFlag=true;save_button_changed()}else{var a=I18N("j","Enabled");c.target.setAttribute("class","checkbox_on");c.target.setAttribute("className","checkbox_on");document.getElementById(c.target.id).innerHTML='<input type="checkbox" name='+c.target.id+" id="+d+' checked="">'+a;document.getElementById(d).checked=true;if(d=="status_vpn_ck"){document.getElementById("userName").disabled=false;document.getElementById("password").disabled=false;document.getElementById("psk").disabled=false;document.getElementById("Save_vpn_btn").style.display="block";document.getElementById("Save_disable_vpn_btn").style.display="none";$("#AuthProtocol").selectbox("enable");$("#MPPE").selectbox("enable")}changeFlag=true;save_button_changed();save_vpn_button_changed()}});GetXML()});</script> <script type="text/javascript">var HNAP=new HNAP_XML();var xml_SetVpnSettings=HNAP.GetXML("SetVpnSettingsAlpha");function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function GetXML(){var a=HNAP.GetXML("GetVpnSettingsAlpha");var g=a.Get("GetVpnSettingsAlphaResponse/CountryCode");if(g=="RU"){document.getElementById("MPPE").remove(2)}var f=a.Get("GetVpnSettingsAlphaResponse/Enabled");if(f=="true"){presetCheckBox("status_vpn",true);document.getElementById("Save_disable_vpn_btn").style.display="none";document.getElementById("Save_vpn_btn").style.display="block"}else{presetCheckBox("status_vpn",false);document.getElementById("userName").disabled=true;document.getElementById("password").disabled=true;document.getElementById("psk").disabled=true;document.getElementById("AuthProtocol").disabled=true;document.getElementById("MPPE").disabled=true;document.getElementById("Save_disable_vpn_btn").style.display="block";document.getElementById("Save_vpn_btn").style.display="none"}var h=a.Get("GetVpnSettingsAlphaResponse/Username");document.getElementById("userName").value=h;var b=a.Get("GetVpnSettingsAlphaResponse/Password");document.getElementById("password").value=b;var d=a.Get("GetVpnSettingsAlphaResponse/PSK");if(d==""){document.getElementById("psk").value=COMM_RandomStr(10)}else{document.getElementById("psk").value=d}var c=a.Get("GetVpnSettingsAlphaResponse/Auth");var e=a.Get("GetVpnSettingsAlphaResponse/Mppe");COMM_SetSelectValue(document.getElementById("AuthProtocol"),c);COMM_SetSelectValue(document.getElementById("MPPE"),e);$("#AuthProtocol").selectbox();$("#MPPE").selectbox();if(document.getElementById("status_vpn_ck").checked!="1"){$("#AuthProtocol").selectbox("disable");$("#MPPE").selectbox("disable")}}function CheckConnectionStatus(){$.ajax({cache:false,url:"./js/CheckConnection",timeout:2000,type:"GET",success:function(a){SetXML()},error:function(){document.getElementById("DetectRouterConnection").style.display="inline"}})}function SetXML(){if(document.getElementById("status_vpn_ck").checked=="1"){xml_SetVpnSettings.Set("SetVpnSettingsAlpha/Enabled","true")}else{xml_SetVpnSettings.Set("SetVpnSettingsAlpha/Enabled","false")}xml_SetVpnSettings.Set("SetVpnSettingsAlpha/Username",document.getElementById("userName").value);xml_SetVpnSettings.Set("SetVpnSettingsAlpha/Password",document.getElementById("password").value);xml_SetVpnSettings.Set("SetVpnSettingsAlpha/PSK",document.getElementById("psk").value);xml_SetVpnSettings.Set("SetVpnSettingsAlpha/Auth",document.getElementById("AuthProtocol").value);xml_SetVpnSettings.Set("SetVpnSettingsAlpha/Mppe",document.getElementById("MPPE").value);var a=HNAP.SetXML("SetVpnSettingsAlpha",xml_SetVpnSettings);document.getElementById("CreatePopAlertMessage2").style.display="inline";setTimeout("waitSettingFinished()",2000)}function SaveConfigurationtoLocal(){var b=HNAP.GetXML("StartVpnDownload");var a=HNAP.SetXML("StartVpnDownload",b);var c=a.Get("StartVpnDownloadResponse/StartVpnDownloadResult");if(c=="OK"){self.location.href="/vpnconfig.php"}}function Start_reciprocal_Number_Reboot(){document.getElementById("reciprocal_Number_Reboot").innerHTML=_ReciprocalRebootNumber+" "+I18N("j","Sec");_ReciprocalRebootNumber--;if(_ReciprocalRebootNumber>=0){setTimeout("Start_reciprocal_Number_Reboot()",1000)}else{document.getElementById("REBOOT").style.display="none";document.getElementById("SuccessREBOOT").style.display="inline"}}function waitSettingFinished(){window.location.reload()}function BasicSetting_hasChanged(){BasicSettinghasChanged=1}function returnToHome(){var a=sessionStorage.getItem("hostname");self.location.href="http://"+a+"/VPN.html"};</script> <script language="JavaScript">$(function(){$("select").change(function(){save_button_changed();save_vpn_button_changed()});$("input").keydown(function(){save_button_changed();save_vpn_button_changed()})});function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block";changeFlag=true}function save_vpn_button_changed(){document.getElementById("Save_disable_vpn_btn").style.display="block";document.getElementById("Save_vpn_btn").style.display="none";changeFlag=true};</script> <style>#advancedBlock{display:none}</style> </head> <body> <form name="vpn_form" id="vpn_form" method="POST" action=""> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Quick VPN");</script></div> <div id="wallimage"><img src="image/page_network2.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Quickly and easily create a profile for secure remote access to a Local Area Network (LAN). This profile can be used to configure other devices to connect to your LAN via a secure VPN tunnel.");</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Features");</script> >> <script>I18N("h","Quick VPN");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> </ul> </div> <div id="main"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","General");</script></div></td> </tr> <tr> <th><script>I18N("h","L2TP over IPSec");</script>:</th> <td><div id="status_vpn" class="checkbox_on"><input type="checkbox" name="status_vpn" id="status_vpn_ck" checked></div></td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" name="userName" size="30" maxlength="15" id="userName"></td> </tr> <tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="text" name="password" size="30" maxlength="15" id="password"></td> </tr> <tr> <th><script>I18N("h","PSK");</script>:</th> <td><input class="styled-text" type="text" name="psk" size="30" maxlength="64" id="psk"></td> </tr> <tr> <th><script>I18N("h","Save Configuration To Local Hard Drive");</script>:</th> <td style="display:block"> <button type="button" class="styled_button_s" id="Save_vpn_btn" onclick="SaveConfigurationtoLocal()" style="display:none"><script>I18N("h","Save");</script></button> <button type="button" class="styled_button_s" id="Save_disable_vpn_btn" style="display:none"><script>I18N("h","Save");</script></button> </td> </tr> </tbody> </table> </div> </div> <div class="advButton" onclick="showAdv('advancedBlock');"><script>I18N("h","Advanced Settings");</script>...</div> <hr/> <div id="advancedBlock"> <table class="block" style="margin: 10px 0 0 0;"> <tbody> <tr> <td><div class="title"><script>I18N("h","Advanced");</script></div></td> </tr> <tr> <th><script>I18N("h","Authentication Protocol");</script>:</th> <td> <div class="styled-select"> <select name="AuthProtocol" id="AuthProtocol"> <option value="MSCHAPv2" selected>MSCHAPv2</option> <option value="PAP">PAP</option> <option value="CHAP">CHAP</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","MPPE");</script>:</th> <td> <div class="styled-select"> <select name="MPPE" id="MPPE"> <option value="none">None</option> <option value="RC4-40">RC4-40</option> <option value="RC4-128" selected>RC4-128</option> </select> </div> </td> </tr> </tbody> </table> </div> <div id="CreatePopAlertMessage2" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td> <center><div id="Loading_pop_image2"></div></center> </td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> </form> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.addMethod("checkSetValues",function(e,d){var b=d.id;var c="";if(b=="userName"){if(e==""||e==null){c=I18N("j","Please enter a username.")}else{if(e.length>15){c=I18N("j","Username must be less than 15 characters length.")}}}if(b=="password"){if(e==""||e==null){c=I18N("j","Please enter a password.")}else{if(e.length>15){c=I18N("j","Password must be less than 15 characters length.")}}}if(b=="psk"){if(e==""||e==null){c=I18N("j","Please enter a PSK.")}else{if(e.length>64||e.length<6){c=I18N("j","Your PSK must be between 6-64 characters length.")}}}return c},"");$("#vpn_form").validate({submitHandler:function(b){CheckConnectionStatus()}});var a=$("#userName, #password, #psk");$.each(a,function(c,b){$(this).rules("add",{checkSetValues:true})})});</script> </body> <script type="text/javascript">Load_HTML();Initial();setMenu("menu_Advanced");checkTimeout();</script> </html>