<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel="stylesheet" type="text/css" href="css/style_pages.css" media="all"/> <link href="css/jquery.selectbox.css" type="text/css" rel="stylesheet"/> <script type="text/javascript" charset="utf-8" src="./js/comm.js"></script> <script type="text/javascript" charset="utf-8" src="./js/hmac_md5.js"></script> <script type="text/javascript" charset="utf-8" src="./js/libajax.js"></script> <script type="text/javascript" charset="utf-8" src="./js/hnap.js"></script> <script type="text/javascript" charset="utf-8" src="./js/i18n.js"></script> <script type="text/javascript" charset="utf-8" src="./js/jquery-1.8.2.min.js"></script> <script type="text/javascript" charset="utf-8" src="./js/pagetool.js"></script> <script type="text/javascript" charset="utf-8" src="./js/jquery.selectbox-0.2_new.js"></script> <script type="text/javascript" charset="utf-8" src="./js/jquery.validate.js"></script> <script type="text/javascript" charset="utf-8" src="./js/includeLang.js"></script> <script type="text/javascript" charset="utf-8" src="./js/messageDescription.js"></script> <script type="text/javascript" charset="utf-8" src="./js/checkTimeout.js"></script> <script type="text/javascript">$(function(){$("#address_mode_pppoe").selectbox();$("#reconnect_mode_pppoe").selectbox();$("#reconnect_mode_wifi_usb").selectbox();$("#authp_wifi_usb").selectbox();$("#country_wifi_usb").selectbox();$("#security_hotspot_client").selectbox();$("#clone_mac_ip").selectbox();$("#pwl_hotspot_client").selectbox()});function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function Load_HTML(){$("#header").load("header.html")}var url=window.location.toString();var proname="";var method="";var type="";if(url.indexOf("?")!=-1){var para=url.split("?");for(var i=0;i<para.length;i++){if(para[i].indexOf("=")!=-1){if(para[i].indexOf("&")!=-1){var subpara=para[i].split("&");var arg_m=subpara[0].split("=");if(arg_m[0]=="method"){method=decodeURIComponent(arg_m[1])}var arg_p=subpara[1].split("=");if(arg_p[0]=="profile"){proname=decodeURIComponent(arg_p[1])}}else{var arg=para[i].split("=");if(arg[0]=="method"){method=decodeURIComponent(arg[1])}}}}}function OBJ(a){if(document.getElementById){return document.getElementById(a)}else{if(document.all){return document.all[a].style}else{if(document.layers){return document.layers[a]}else{return false}}}}function set_select_value(c,b){for(var a=0;a<c.length;a+=1){if(c[a].value==b){c.selectedIndex=a;break}}return c.selectedIndex}function add_select_option(e,c,f){var b=false;for(var a=0;a<e.length;a++){if(e.options[a].value==c){b=true;break}}if(!b){var d=new Option(f,c);e.options.add(d)}}function remove_opt(a){if(a==null){return}if(a.options==null){return}a.options.length=0}var selected_ssid=null;var def_security=null;function InjectTable(d,e,b,g){var l=OBJ(d).getElementsByTagName("tr");var a=null;var j=null;var c;var f;var k=false;selected_ssid=null;def_security=null;for(c=0;!k&&c<l.length;c++){if(l[c].id==e){k=true}}if(k){for(c=0;c<b.length;c++){j=OBJ(e+"_"+c);switch(g[c]){case"text":f=b[c];if(typeof(j.innerText)!=="undefined"){j.innerText=f}else{if(typeof(j.textContent)!=="undefined"){j.textContent=f}else{j.innerHTML=f}}break;default:f=b[c];j.innerHTML=f;break}}return}a=OBJ(d).insertRow(l.length);a.id=e;a.onclick=function(m){selected_ssid=b[0];if(b[3]=="NONE"){def_security="NONE"}else{if(b[3].indexOf("WEP")==0){def_security="WEP"}else{def_security="WPA+2PSK"}}ChangeBgcolor(d,e)};for(c=0;c<b.length-1;c++){j=a.insertCell(c);j.id=e+"_"+c;j.className="content";switch(g[c]){case"text":f=b[c];if(typeof(j.innerText)!=="undefined"){j.innerText=f}else{if(typeof(j.textContent)!=="undefined"){j.textContent=f}else{j.innerHTML=f}}break;default:f=b[c];j.innerHTML=f;break}}}function CleanTable(a){table=OBJ(a);var b=table.getElementsByTagName("tr");while(b.length>1){table.deleteRow(b.length-1)}}function pro_show_general(a){switch(a){case"DHCP":OBJ("general_dhcp").style.display="block";OBJ("general_pppoe").style.display="none";OBJ("general_wifi_usb").style.display="none";OBJ("general_hotspot_client").style.display="none";OBJ("general_static").style.display="none";OBJ("advanced_str").style.display="none";break;case"PPPoE":OBJ("general_dhcp").style.display="none";OBJ("general_pppoe").style.display="block";OBJ("general_wifi_usb").style.display="none";OBJ("general_hotspot_client").style.display="none";OBJ("general_static").style.display="none";OBJ("advanced_str").style.display="block";break;case"USB3G":OBJ("general_dhcp").style.display="none";OBJ("general_pppoe").style.display="none";OBJ("general_wifi_usb").style.display="block";OBJ("general_hotspot_client").style.display="none";OBJ("general_static").style.display="none";OBJ("advanced_str").style.display="block";break;case"WISP":OBJ("general_dhcp").style.display="none";OBJ("general_pppoe").style.display="none";OBJ("general_wifi_usb").style.display="none";OBJ("general_hotspot_client").style.display="block";OBJ("general_static").style.display="none";OBJ("advanced_str").style.display="none";break;case"STATIC":OBJ("general_dhcp").style.display="none";OBJ("general_pppoe").style.display="none";OBJ("general_wifi_usb").style.display="none";OBJ("general_hotspot_client").style.display="none";OBJ("general_static").style.display="block";OBJ("advanced_str").style.display="block";break}OBJ("advanced_pppoe").style.display="none";OBJ("advanced_wifi_usb").style.display="none";OBJ("advanced_static").style.display="none"}function pro_show_advanced(){var a=null;if(method=="add"){a=OBJ("pro_type").value}else{if(method=="edit"){a=type}}switch(a){case"PPPoE":showAdv("advanced_pppoe");break;case"USB3G":showAdv("advanced_wifi_usb");break;case"WISP":break;case"STATIC":showAdv("advanced_static");break}}function pppoe_mode_type(a){switch(a){case"DYNAMICIP":OBJ("ipaddr_tr").style.display="none";break;case"STATICIP":OBJ("ipaddr_tr").style.display="table-row";break}}function recmode_type(b,a){switch(a){case"alwayson":case"manual":OBJ(b).style.display="none";break;case"ondemand":OBJ(b).style.display="table-row";break}}function security_mode(a){switch(a){case"NONE":OBJ("pwl_tr").style.display="none";OBJ("passwd_tr").style.display="none";break;case"WEP":OBJ("pwl_tr").style.display="table-row";OBJ("passwd_tr").style.display="table-row";break;case"WPAPSK":case"WPA2PSK":case"WPA+2PSK":OBJ("pwl_tr").style.display="none";OBJ("passwd_tr").style.display="table-row";break}}var dhcp_mac=null;function select_mac_addr(b,a){if(a==0){OBJ("mac_ipaddr").value=dhcp_mac}else{OBJ("mac_ipaddr").value=b.options[a].text}}function ChangeBgcolor(a,c){var e=OBJ(a).getElementsByTagName("tr");for(var b=0;b<e.length;b++){var d=e[b].getAttribute("id");if(d==c){OBJ(c).style.backgroundColor="#CCC"}else{OBJ(d).style.backgroundColor="#FFF"}}}function OnClickSelect(){$("#security_hotspot_client").selectbox("detach");OBJ("ssid_hotspot_client").value=selected_ssid;set_select_value(OBJ("security_hotspot_client"),def_security);security_mode(def_security);$("#security_hotspot_client").selectbox();OBJ("CreatePopAlertMessage").style.display="none";OBJ("scan_waiting").style.display="none";OBJ("scan_list").style.display="none"}function OnClickScan(){$("#security_hotspot_client").selectbox("detach");OBJ("CreatePopAlertMessage").style.display="block";OBJ("scan_waiting").style.display="block";OBJ("ssid_hotspot_client").value=null;set_select_value(OBJ("security_hotspot_client"),"NONE");security_mode("NONE");$("#security_hotspot_client").selectbox();var b=HNAP.GetXML("SetTriggerWirelessSiteSurvey");b.Set("SetTriggerWirelessSiteSurvey/RadioID","RADIO_2.4GHz");var a=HNAP.SetXML("SetTriggerWirelessSiteSurvey",b);var c=a.Get("SetTriggerWirelessSiteSurveyResponse/WaitTime");var d=a.Get("SetTriggerWirelessSiteSurveyResponse/SetTriggerWirelessSiteSurveyResult");setTimeout('ShowSiteSurveyLists("'+d+'")',c*1000)}function close_hotspot_list(){OBJ("CreatePopAlertMessage").style.display="none";OBJ("scan_waiting").style.display="none";OBJ("scan_list").style.display="none"}function reload_hotspot_list(){OBJ("CreatePopAlertMessage").style.display="block";OBJ("scan_list").style.display="none";OBJ("scan_waiting").style.display="block";OBJ("ssid_hotspot_client").value=null;var b=HNAP.GetXML("SetTriggerWirelessSiteSurvey");b.Set("SetTriggerWirelessSiteSurvey/RadioID","RADIO_2.4GHz");var a=HNAP.SetXML("SetTriggerWirelessSiteSurvey",b);var c=a.Get("SetTriggerWirelessSiteSurveyResponse/WaitTime");var d=a.Get("SetTriggerWirelessSiteSurveyResponse/SetTriggerWirelessSiteSurveyResult");setTimeout('ShowSiteSurveyLists("'+d+'")',c*1000)}var HNAP=new HNAP_XML();var xml_GetISPList=HNAP.GetXML("GetISPListAlpha");var total_isp=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList#");function Array2DVar(a,c){this.length=a;this.x=a;this.y=c;for(var b=0;b<this.length;b++){this[b]=new Array(c)}}function InitClientInfo(){var a=HNAP.GetXML("GetClientInfo");var c=0;var d=a.Get("GetClientInfoResponse/ClientInfoLists/ClientInfo#");array2Dv=new Array2DVar(d,1);for(var b=1;b<=d;b++){array2Dv[c][0]=a.Get("GetClientInfoResponse/ClientInfoLists/ClientInfo:"+b+"/MacAddress");clone_mac_ip.options.add(new Option(array2Dv[c][0],b));c++}}function InitCountryList(){var a=new Array();for(var b=0;b<total_isp;b++){var c=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+b+"/Country");a.push(c)}a.sort();a.push("Others");for(var b=0;b<a.length;b++){add_select_option(OBJ("country_wifi_usb"),a[b],a[b])}}function OnChangeCountryList(d){var g,a;var f=new Array();remove_opt(OBJ("isp_wifi_usb"));$("#isp_wifi_usb").selectbox("detach");for(var c=0;c<total_isp;c++){var k=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+c+"/Country");if(d==k){a=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+c+"/ISPList#");g=c;break}}for(var b=1;b<=a;b++){var e=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+g+"/ISPList:"+b+"/ProfileName");f.push(e)}f.sort();for(var c=0;c<f.length;c++){add_select_option(OBJ("isp_wifi_usb"),f[c],f[c])}if(d!="Others"){OBJ("isp_wifi_usb_tr").style.display="table-row";$("#isp_wifi_usb").selectbox()}else{OBJ("isp_wifi_usb_tr").style.display="none"}}function EventSiteSurveyList(){var b=HNAP.GetXML("SetTriggerWirelessSiteSurvey");b.Set("SetTriggerWirelessSiteSurvey/RadioID","RADIO_2.4GHz");var a=HNAP.SetXMLAsync("SetTriggerWirelessSiteSurvey",b);alert(a.Get("SetTriggerWirelessSiteSurveyResponse/SetTriggerWirelessSiteSurveyResult"));return res}var total_lists_24g=0;var total_lists_5g=0;var total_sslists=0;var list_arr=new Array();var h=0;function ShowSiteSurveyLists(a){CleanTable("content_tb");if(a=="OK"){setTimeout('AddSiteSurveyLists("RADIO_5GHz")',1000);setTimeout('AddSiteSurveyLists("RADIO_2.4GHz")',1000);setTimeout("DrawSiteSurveyList()",3000)}else{setTimeout("EventSiteSurveyList()",2000)}}function AddSiteSurveyLists(d){var c=HNAP.GetXML("GetSiteSurvey",new Array("RadioID",d));var b=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo#");for(var f=1;f<=b;f++){var g=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+f+"/SignalStrength");var a=c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+f+"/SupportedSecurity/SecurityInfo/SecurityType");var j=null;var e=null;if(a!="NONE"){j='<img src="image/wisp_security.png" width="12" height="21"/>'}else{j=null}if(parseInt(g)<=35){e='<img src="image/wisp_strength_low.png" width="25" height="20"/>'}else{if(parseInt(g)<=70&&parseInt(g)>35){e='<img src="image/wisp_strength_medium.png" width="25" height="20"/>'}else{if(parseInt(g)<=100&&parseInt(g)>70){e='<img src="image/wisp_strength_high.png" width="25" height="20"/>'}}}list_arr[h]={ssid:c.Get("GetSiteSurveyResponse/APStatInfoLists/APStatInfo:"+f+"/SSID"),rssi_img:e,sec_img:j,sec_type:a};h++}}function DrawSiteSurveyList(){var b=Math.floor((Math.random()*10)+1);for(var a=0;a<list_arr.length;a++){var g=list_arr[a].ssid;var j=list_arr[a].rssi_img;var f=list_arr[a].sec_img;var e=list_arr[a].sec_type;var d=[g,j,f,e];var c=["text","img","img","text"];InjectTable("content_tb","hotspot"+b+"-"+a,d,c)}OBJ("CreatePopAlertMessage").style.display="block";OBJ("scan_waiting").style.display="none";OBJ("scan_list").style.display="block";h=0}function OnChangeISPList(a){var f,k,e;var g=OBJ("country_wifi_usb").value;for(var d=0;d<total_isp;d++){var b=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+d+"/Country");if(g==b){k=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+d+"/ISPList#");f=d;break}}for(var c=1;c<=k;c++){var l=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+f+"/ISPList:"+c+"/ProfileName");if(a==l){e=c;break}}OBJ("dialno_wifi_usb").value=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+f+"/ISPList:"+e+"/DialNumber");OBJ("apn_wifi_usb").value=xml_GetISPList.Get("GetISPListAlphaResponse/CountryList:"+f+"/ISPList:"+e+"/APN")}var pro_name=null;var connect_text=null;var init_type=null;var xml_GetSIMCardInfo=HNAP.GetXML("GetSIMCardInfoAlpha");var pinsts=xml_GetSIMCardInfo.Get("GetSIMCardInfoAlphaResponse/PINsts");function InitProInfo(){var p=HNAP.GetXML("GetInternetProfileAlpha");var g=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile#");switch(method){case"add":init_type="USB3G";OBJ("pro_type").style.display="table-row";set_select_value(OBJ("pro_type"),init_type);$("#pro_type").selectbox();var j="Others";set_select_value(OBJ("country_wifi_usb"),j);OnChangeCountryList(j);var k=null;if(pinsts=="UNLOCKED"){k="Unlocked"}else{if(pinsts=="READY"){k="Ready"}else{if(pinsts=="ERROR"){k="PIN code error"}else{if(pinsts=="NOSUPPORT"){k="No support"}else{if(pinsts=="LOCKED"){k="Locked"}else{if(pinsts=="PUK"){k="Locked by PUK"}else{if(pinsts=="CHECKING"){k="Checking"}else{k="Unknown"}}}}}}}OBJ("sim_card_status").innerHTML=k;break;case"edit":var n=null;for(var f=1;f<=g;f++){pro_name=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+f+"/ProfileName");var e=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+f+"/ProfileType");if(proname==pro_name){init_type=e;n=f;break}}if(init_type=="DHCP"){OBJ("connect_tr").style.display="none"}else{if(init_type=="STATIC"){connect_text="Static IP"}else{if(init_type=="PPPoE"){connect_text="xDSL Broadband (PPPoE)"}else{if(init_type=="WISP"){connect_text="Wi-Fi Hotspot Client"}else{if(init_type=="USB3G"){connect_text="3G/4G Wireless USB"}}}}}OBJ("pro_type_div").innerHTML="<b>"+connect_text+"</b>";switch(init_type){case"DHCP":OBJ("host_name_dhcp").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/HostName");dhcp_mac=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/MAC");break;case"STATIC":OBJ("ipaddr_static").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/IPAddress");OBJ("mask_static").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/SubnetMask");OBJ("gw_static").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/Gateway");OBJ("primary_dns_static").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/DNS/Primary");OBJ("secondary_dns_static").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/DNS/Secondary");OBJ("mtu_static").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/MTU");break;case"PPPoE":OBJ("pro_name_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ProfileName");OBJ("usr_name_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/UserName");OBJ("passwd_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/Password");var a=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/AddressMode");var q=null;if(a=="StaticPPPoE"){q="STATICIP"}else{q="DYNAMICIP"}set_select_value(OBJ("address_mode_pppoe"),q);pppoe_mode_type(q);OBJ("ipaddr_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/IPAddress");OBJ("service_name_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ServiceName");OBJ("primary_dns_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/DNS/Primary");OBJ("secondary_dns_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/DNS/Secondary");var l=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ReconnectMode");set_select_value(OBJ("reconnect_mode_pppoe"),l);recmode_type("reconnect_mode_pppoe",l);OBJ("max_idle_time_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/MaxIdleTime");OBJ("mtu_pppoe").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/MTU");break;case"WISP":OBJ("ssid_hotspot_client").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ProfileName");var m=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/SecurityType");if(m=="WEP"){var b=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/PasswordLength")}$("#security_hotspot_client").selectbox("detach");set_select_value(OBJ("pwl_hotspot_client"),b);set_select_value(OBJ("security_hotspot_client"),m);security_mode(m);$("#security_hotspot_client").selectbox();OBJ("passwd_hotspot_client").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/Password");break;case"USB3G":OBJ("pro_name_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ProfileName");var d=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/Country");set_select_value(OBJ("country_wifi_usb"),d);OnChangeCountryList(d);$("#isp_wifi_usb").selectbox("detach");var o=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ISP");set_select_value(OBJ("isp_wifi_usb"),o);OnChangeISPList(o);$("#isp_wifi_usb").selectbox();OBJ("dialno_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/DialupNumber");OBJ("apn_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/APN");OBJ("usr_name_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/UserName");OBJ("passwd_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/Password");var c=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/AuthProtocol");set_select_value(OBJ("authp_wifi_usb"),c);var k=null;if(pinsts=="UNLOCKED"){k="Unlocked"}else{if(pinsts=="READY"){k="Ready"}else{if(pinsts=="ERROR"){k="PIN code error"}else{if(pinsts=="NOSUPPORT"){k="No support"}else{if(pinsts=="LOCKED"){k="Locked"}else{if(pinsts=="PUK"){k="Locked by PUK"}else{if(pinsts=="CHECKING"){k="Checking"}else{k="Unknown"}}}}}}}OBJ("sim_card_status").innerHTML=k;var l=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/ReconnectMode");set_select_value(OBJ("reconnect_mode_wifi_usb"),l);recmode_type("wifi_usb_idle_time_tr",l);OBJ("max_idle_time_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/MaxIdleTime");OBJ("mtu_wifi_usb").value=p.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+n+"/MTU");break}break}pro_show_general(init_type);type=init_type}function IsDigit(a){if(a==""||a==null){return false}if(a.toString()!=parseInt(a,10).toString()){return false}return true}function check_ip_validity(b){var c=b.split(".");if(c.length!=4){return false}for(var a=0;a<4;a++){if(!IsDigit(c[a])||c[a]>255){return false}}return true}function SaveProInfo(){var c=HNAP.GetXML("SetInternetProfileAlpha");var a=null;if(method=="add"){a=OBJ("pro_type").value}else{if(method=="edit"){a=type}}switch(a){case"DHCP":c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileName","DHCP Network");c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileType",a);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/HostName",OBJ("host_name_dhcp").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/MAC",OBJ("mac_ipaddr").value);break;case"STATIC":c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileName","Static Network");c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileType",a);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/IPAddress",OBJ("ipaddr_static").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/SubnetMask",OBJ("mask_static").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/Gateway",OBJ("gw_static").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/DNS/Primary",OBJ("primary_dns_static").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/DNS/Secondary",OBJ("secondary_dns_static").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/MTU",OBJ("mtu_static").value);break;case"PPPoE":c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileName",OBJ("pro_name_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileType",a);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/UserName",OBJ("usr_name_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/Password",OBJ("passwd_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/AddressMode",OBJ("address_mode_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/IPAddress",OBJ("ipaddr_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ServiceName",OBJ("service_name_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ReconnectMode",OBJ("reconnect_mode_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/MaxIdleTime",OBJ("max_idle_time_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/DNS/Primary",OBJ("primary_dns_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/DNS/Secondary",OBJ("secondary_dns_pppoe").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/MTU",OBJ("mtu_pppoe").value);if(method=="edit"&&(pro_name!=OBJ("pro_name_pppoe").value)){window.location.href="./Internet_ProAdd.html?method=edit&profile="+OBJ("pro_name_pppoe").value}break;case"WISP":c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileName",OBJ("ssid_hotspot_client").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileType",a);var b=OBJ("security_hotspot_client").value;c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/SecurityType",b);if(b=="WEP"){c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/PasswordLength",OBJ("pwl_hotspot_client").value)}c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/Password",OBJ("passwd_hotspot_client").value);break;case"USB3G":c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileName",OBJ("pro_name_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ProfileType",a);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/DialupNumber",OBJ("dialno_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/APN",OBJ("apn_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/Country",OBJ("country_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ISP",OBJ("isp_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/UserName",OBJ("usr_name_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/Password",OBJ("passwd_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/AuthProtocol",OBJ("authp_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/SIMCardStatus",pinsts);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ReconnectMode",OBJ("reconnect_mode_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/MaxIdleTime",OBJ("max_idle_time_wifi_usb").value);c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/MTU",OBJ("mtu_wifi_usb").value);break}var d=HNAP.SetXML("SetInternetProfileAlpha",c);document.getElementById("CreatePopAlertMessage2").style.display="inline";setTimeout('window.location.replace("./Internet_Pro.html")',1000)}$(function(){$("input, textarea, select").change(function(){changeFlag=true;save_button_changed()})});function save_button_changed(){document.getElementById("Save_Disable_btn").style.display="none";document.getElementById("Save_btn").style.display="block"};</script> <style>.button_radius{border-radius:5px;border:solid 1px #4394a7;COLOR:#fff;background-color:#4394a7;width:80px;height:30px;text-align:center}.button_radius2{border-radius:5px;background-color:#007086;border:solid 1px #FFF;color:#fff;width:80px;height:30px;text-align:center}.scanPopBox{position:relative;top:100px;width:331px;height:auto;margin:0 auto}.wait_scan_box{position:relative;text-align:center;top:100px;left:80px;width:222px;height:206px;background:url("../image/wisp_loading.png") left top repeat-y}.scan_lists_box{border-radius:10px;position:relative;top:100px;background-color:#007086;border:solid 1px #FFF;color:#FFF;padding:10px;width:331px;height:auto;text-align:left}.content_div{color:#333;background-color:#FFF;width:100%;height:250px;overflow:auto}div.emptyline{height:12px}label.error{background:url("./image/disconnected.png") no-repeat 0 0;background-size:16px 16px;padding-left:20px;color:red;margin:0 0 0 5px}</style> </head> <body> <form id="internet_pro_form" method="POST" action=""> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Internet Profiles");</script></div> <div id="wallimage"><img src="image/internet_page.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Use this section to configure your Internet Connection profiles. If you are not sure what settings to use, please contact your Internet Service Provider.");</script> <br/> <script>I18N("h","<b>Note</b>: If you are using a PPPoE connection, you will need to remove or disable any PPPoE client software running on your computers.");</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script> >> <script>I18N("h","Internet Profiles");</script></div> <ul id="rightFunc"> <li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h","Save");</script></div></li> <li style="display:block"><div id="Save_Disable_btn"><script>I18N("h","Save");</script></div></li> <input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none"/> </ul> </div> <div id="main"> <table class="block" border="0" style="margin: 0px;"> <tbody> <tr id="connect_tr" style="display:block;"> <th><script>I18N("h","My Internet Connection is");</script>:</th> <td> <div id="pro_type_div" class="styled-select"> <select id="pro_type" onChange="pro_show_general(this.value);" style="display:none;"> <option value="USB3G">3G/4G Wireless USB</option> <option value="WISP">Wi-Fi Hotspot Client</option> </select> </div> </td> </tr> </tbody> </table> <div id="general_dhcp" style="display:none;"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","Host Name");</script>:</th> <td><input class="styled-text" type="text" id="host_name_dhcp" size="27"></td> </tr> <tr> <th><script>I18N("h","Mac Address Clone");</script>:</th> <td><input class="styled-text" type="text" id="mac_ipaddr" size="27"></td> <td> <div class="styled-select"> <select id="clone_mac_ip" onChange="select_mac_addr(this, this.value)"> <option value="0">&lt;&lt; Computer Name...</option> </select> </div> </td> </tr> </tbody> </table> </div> <div id="general_pppoe" style="display:none;"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Profile Name");</script>:</th> <td><input class="styled-text" type="text" id="pro_name_pppoe" name="pro_name_pppoe" size="27"></td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" id="usr_name_pppoe" name="usr_name_pppoe" size="27"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="password" id="passwd_pppoe" name="passwd_pppoe" size="27"></td> </tr> </tbody> </table> </div> <div id="general_wifi_usb" style="display:none;"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Profile Name");</script>:</th> <td><input class="styled-text" type="text" id="pro_name_wifi_usb" name="pro_name_wifi_usb" size="27"></td> </tr> <tr> <th><script>I18N("h","Dial-up Number");</script>:</th> <td><input class="styled-text" type="text" id="dialno_wifi_usb" name="dialno_wifi_usb" size="27"></td> </tr> <tr> <th><script>I18N("h","APN");</script>:</th> <td><input class="styled-text" type="text" id="apn_wifi_usb" name="apn_wifi_usb" size="27"></td> </tr> </tbody> </table> </div> <div id="general_hotspot_client" style="display:none;"> <table class="block"> <tbody> <tr> <th><script>I18N("h","Hotspot Network Name(SSID)");</script>:</th> <td width="220px"> <input class="styled-text" type="text" id="ssid_hotspot_client" name="ssid_hotspot_client" size="27"/> </td> <td> <input type="button" class="button_radius" value="Scan" onClick="OnClickScan()" style="cursor:pointer"/> </td> </tr> <tr> <th><script>I18N("h","Security");</script>:</th> <td> <div class="styled-select"> <select id="security_hotspot_client" onChange="security_mode(this.value)"> <option value="NONE">None</option> <option value="WEP">WEP</option> <option value="WPA+2PSK">WPA/WPA2-Personal</option> </select> </div> </td> <td></td> </tr> <tr id="pwl_tr" style="display:none;"> <th><script>I18N("h","Password Length");</script>:</th> <td> <div class="styled-select"> <select id="pwl_hotspot_client"> <option value="64Hex">64 bit(10 hex digits)</option> <option value="64ASCII">64 bit(5 ascii characters)</option> <option value="128Hex">128 bit(26 hex digits)</option> <option value="128ASCII">128 bit(13 ascii characters)</option> </select> </div> </td> <td></td> </tr> <tr id="passwd_tr" style="display:none;"> <th><script>I18N("h","Password");</script>:</th> <td><input id="passwd_hotspot_client" name="passwd_hotspot_client" class="styled-text" type="password" size="27"></td> <td></td> </tr> </tbody> </table> </div> <div id="general_static" style="display:none;"> <table class="block" border="0"> <tbody> <tr> <th><script>I18N("h","IP Address");</script>:</th> <td><input class="styled-text" type="text" id="ipaddr_static" name="ipaddr_static_req" size="27"></td> </tr> <tr> <th><script>I18N("h","Subnet Mask");</script>:</th> <td><input class="styled-text" type="text" id="mask_static" name="mask_static_req" size="27"></td> </tr> <tr> <th><script>I18N("h","Default Gateway");</script>:</th> <td><input class="styled-text" type="text" id="gw_static" name="gw_static_req" size="27"></td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td><input class="styled-text" type="text" id="primary_dns_static" name="primary_dns_req" size="27"></td> </tr> </tbody> </table> </div> <div id="advanced_str" class="advButton" onclick="pro_show_advanced()" style="display:none;"> <script>I18N("h","Advanced Settings");</script>... <hr/> </div> <div id="advanced_block"> <div id="advanced_pppoe" style="display:none;"> <table class="block" border="0"><tbody> <tr> <th><script>I18N("h","Address Mode");</script>:</th> <td> <div class="styled-select"> <select id="address_mode_pppoe" onChange="pppoe_mode_type(this.value)"> <option value="DYNAMICIP">Dynamic IP</option> <option value="STATICIP">Static IP</option> </select> </div> </td> </tr> <tr id="ipaddr_tr" style="display:none;"> <th><script>I18N("h","IP Address");</script>:</th> <td><input class="styled-text" type="text" id="ipaddr_pppoe" name="ipaddr_pppoe_req" size="27"></td> </tr> <tr> <th><script>I18N("h","Service Name");</script>:</th> <td><input class="styled-text" type="text" id="service_name_pppoe" size="27"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select id="reconnect_mode_pppoe" onChange="recmode_type('idle_time_tr', this.value);"> <option value="alwayson">Always on</option> <option value="ondemand">On demand</option> <option value="manual">Manual</option> </select> </div> </td> </tr> <tr id="idle_time_tr" style="display:none;"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input id="max_idle_time_pppoe" class="styled-text" type="text" size="15">&nbsp;&nbsp;minutes</td> </tr> <tr> <th><script>I18N("h","Primary DNS Server");</script>:</th> <td><input class="styled-text" type="text" id="primary_dns_pppoe" size="27"></td> </tr> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td><input class="styled-text" type="text" id="secondary_dns_pppoe" size="27"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td><input class="styled-text" type="text" id="mtu_pppoe" value="1500" size="8"></td> </tr> </tbody></table> </div> <div id="advanced_wifi_usb" style="display:none;"> <table class="block" border="0"><tbody> <tr> <th><script>I18N("h","Country");</script>:</th> <td> <div class="styled-select"> <select id="country_wifi_usb" onChange="OnChangeCountryList(this.value)"> </select> </div> </td> </tr> <tr id="isp_wifi_usb_tr"> <th><script>I18N("h","ISP");</script>:</th> <td> <div class="styled-select"> <select id="isp_wifi_usb" onChange="OnChangeISPList(this.value)"> </select> </div> </td> </tr> <tr> <th><script>I18N("h","Username");</script>:</th> <td><input class="styled-text" type="text" id="usr_name_wifi_usb" size="27"></td> </tr> <tr> <th><script>I18N("h","Password");</script>:</th> <td><input class="styled-text" type="password" id="passwd_wifi_usb" size="27"></td> </tr> <tr> <th><script>I18N("h","Authentication Protocol");</script>:</th> <td> <div class="styled-select"> <select id="authp_wifi_usb"> <option value="auto">Auto(PAP+CHAP)</option> <option value="PAP">PAP</option> <option value="CHAP">CHAP</option> </select> </div> </td> </tr> <tr> <th><script>I18N("h","SIM Card Status");</script>:</th> <td id="sim_card_status"></td> </tr> <tr> <th><script>I18N("h","Reconnect Mode");</script>:</th> <td> <div class="styled-select"> <select id="reconnect_mode_wifi_usb" onChange="recmode_type('wifi_usb_idle_time_tr', this.value)"> <option value="alwayson">Always on</option> <option value="ondemand">On demand</option> <option value="manual">Manual</option> </select> </div> </td> </tr> <tr id="wifi_usb_idle_time_tr" style="display:none;"> <th><script>I18N("h","Maximum Idle Time");</script>:</th> <td><input id="max_idle_time_wifi_usb" class="styled-text" type="text" size="15">&nbsp;&nbsp;minutes</td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td><input class="styled-text" type="text" id="mtu_wifi_usb" value="1500" size="8"></td> </tr> </tbody></table> </div> <div id="advanced_static" style="display:none;"> <table class="block" border="0"><tbody> <tr> <th><script>I18N("h","Secondary DNS Server");</script>:</th> <td><input class="styled-text" type="text" id="secondary_dns_static" size="27" maxlength="15"></td> </tr> <tr> <th><script>I18N("h","MTU");</script>:</th> <td><input class="styled-text" type="text" id="mtu_static" value="1500" size="8"></td> </tr> </tbody></table> </div> </div> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> <div id="CreatePopAlertMessage" style="display:none"> <div class="scanPopBox"> <div id="scan_waiting" class="wait_scan_box" style="display:none"> <br/> <br/> <br/> <center><img src="image/loading.gif" border="0"></center> <div><span><script>I18N("h","Scanning...");</script></span></div> <br/> </div> <div id="scan_list" class="scan_lists_box" style="display:none"> <div id="scan_list_title"> <table width="100%" cellspacing="0" cellpadding="0" border="0"> <tbody> <tr> <td><b><script>I18N("h","Available hotspot networks");</script></b></td> <td style="text-align: right;"> <a href="javascript:reload_hotspot_list()"><img src="image/wisp_reload.gif" border="0"></a> <a href="javascript:close_hotspot_list()"><img src="image/wisp_close.gif" width="24" height="25" border="0"></a> </td> </tr> </tbody> </table> </div> <div class="emptyline"></div> <div id="scan_list_content"> <div class="content_div"> <table id="content_tb" width="100%" cellspacing="0" cellpadding="5" border="0" style="cursor:pointer"> </table> </div> </div> <div class="emptyline"></div> <div id="scan_list_slb"> <center><input type="button" class="button_radius2" value="Select" onClick="OnClickSelect()" style="cursor:pointer"/></center> </div> <div class="emptyline"></div> </div> </div> </div> <div id="CreatePopAlertMessage2" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0"> <tbody> <tr> <td><center><div id="Loading_pop_image2"></div></center></td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> </div> </div> </div> </form> <script type="text/javascript" charset="utf-8">$(document).ready(function(){$.validator.setDefaults({submitHandler:function(a){a.submit()}});$.validator.addMethod("checkStaticIPForm",function(e,a){var d=null;if(method=="add"){d=document.getElementById("pro_type").value}else{if(method=="edit"){d=init_type}}var b=true;if(d!="STATIC"){b=true}else{var c=/(^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))+$/;if(c.test(e)){b=true}else{b=false}}return b},jQuery.validator.messages.address_Check);$.validator.addMethod("checkPPPoEInfo",function(f,b){var e=null;if(method=="add"){e=document.getElementById("pro_type").value}else{if(method=="edit"){e=init_type}}var a=document.getElementById("address_mode_pppoe").value;var c=true;if(e!="PPPoE"){c=true}else{if(a=="DYNAMICIP"){c=true}else{var d=/(^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))+$/;if(d.test(f)){c=true}else{c=false}}}return c},jQuery.validator.messages.address_Check);$.validator.addMethod("checkWEPPassword",function(e,b){var d=null;if(method=="add"){d=document.getElementById("pro_type").value}else{if(method=="edit"){d=init_type}}var c=true;if(d!="WISP"){c=true}else{var a=document.getElementById("security_hotspot_client").value;if(a!="WEP"){c=true}else{var f=document.getElementById("pwl_hotspot_client").value;if(f=="64Hex"&&e.length!=10){c=false}else{if(f=="64ASCII"&&e.length!=5){c=false}else{if(f=="128Hex"&&e.length!=26){c=false}else{if(f=="128ASCII"&&e.length!=13){c=false}}}}}}return c},jQuery.validator.messages.password_WEPCheck);$.validator.addMethod("checkWPAPassword",function(e,b){var d=null;if(method=="add"){d=document.getElementById("pro_type").value}else{if(method=="edit"){d=init_type}}var c=true;if(d!="WISP"){c=true}else{var a=document.getElementById("security_hotspot_client").value;if(a=="WPAPSK"||a=="WPA2PSK"||a=="WPA+2PSK"){if(e.length>63||e.length<8){c=false}}else{c=true}}return c},jQuery.validator.messages.password_WPACheck);$("#internet_pro_form").validate({rules:{ipaddr_static_req:{required:true,checkStaticIPForm:true},mask_static_req:{required:true,checkStaticIPForm:true},gw_static_req:{required:true,checkStaticIPForm:true},primary_dns_req:{required:true,checkStaticIPForm:true},pro_name_pppoe:"required",usr_name_pppoe:"required",passwd_pppoe:"required",ipaddr_pppoe_req:{required:true,checkPPPoEInfo:true},ssid_hotspot_client:"required",passwd_hotspot_client:{required:true,checkWEPPassword:true,checkWPAPassword:true},pro_name_wifi_usb:"required",dialno_wifi_usb:"required",apn_wifi_usb:"required"},submitHandler:function(a){SaveProInfo()}})});</script> </body> <script type="text/javascript">Load_HTML();Initial();InitCountryList();InitProInfo();InitClientInfo();checkTimeout();setMenu("menu_Settings");</script> </html>