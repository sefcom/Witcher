<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3c.org/1999/xhtml" xml:lang="zh_TW" lang="zh_TW"> <head> <title>D-LINK</title> <meta http-equiv="X-UA-Compatible" content="IE=9"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <meta http-equiv="Content-Type" content="text/css"> <link rel="stylesheet" type="text/css" href="css/style_pages.css" media="all"/> <link href="css/jquery.selectbox.css" type="text/css" rel="stylesheet"/> <script type="text/javascript" charset="utf-8" src="./js/comm.js"></script> <script type="text/javascript" charset="utf-8" src="./js/hmac_md5.js"></script> <script type="text/javascript" charset="utf-8" src="./js/jquery-1.8.2.min.js"></script> <script type="text/javascript" charset="utf-8" src="./js/libajax.js"></script> <script type="text/javascript" charset="utf-8" src="./js/hnap.js"></script> <script type="text/javascript" charset="utf-8" src="./js/i18n.js"></script> <script type="text/javascript" charset="utf-8" src="./js/pagetool.js"></script> <script type="text/javascript" charset="utf-8" src="./js/checkTimeout.js"></script> <script type="text/javascript" charset="utf-8" src="./js/jquery.selectbox-0.2_new.js"></script> <script type="text/javascript" charset="utf-8" src="./js/jquery.validate.js"></script> <script type="text/javascript" charset="utf-8" src="./js/includeLang.js"></script> <script type="text/javascript" charset="utf-8" src="./js/messageDescription.js"></script> <script type="text/javascript">var HNAP=new HNAP_XML();var total_pro=0;var xml_GetProInfo=HNAP.GetXML("GetInternetProfileAlpha");var NowLang=localStorage.language;InitLANG(NowLang);function Load_HTML(){$("#header").load("header.html")}function Initial(){initialMenu();initialDetectRouterConnection()}function Load_HTML(){$("#header").load("header.html")}function OBJ(a){if(document.getElementById){return document.getElementById(a)}else{if(document.all){return document.all[a].style}else{if(document.layers){return document.layers[a]}else{return false}}}}function InjectTable(d,e,b,g){var k=OBJ(d).getElementsByTagName("tr");var a=null;var h=null;var c;var f;var j=false;for(c=0;!j&&c<k.length;c++){if(k[c].id==e){j=true}}if(j){for(c=0;c<b.length;c++){h=OBJ(e+"_"+c);switch(g[c]){case"text":f=b[c];if(typeof(h.innerText)!=="undefined"){h.innerText=f}else{if(typeof(h.textContent)!=="undefined"){h.textContent=f}else{h.innerHTML=f}}break;default:f=b[c];h.innerHTML=f;break}}return}a=OBJ(d).insertRow(k.length);a.id=e;for(c=0;c<b.length;c++){h=a.insertCell(c);h.id=e+"_"+c;h.className="content";switch(g[c]){case"text":f=b[c];if(typeof(h.innerText)!=="undefined"){h.innerText=f}else{if(typeof(h.textContent)!=="undefined"){h.textContent=f}else{h.innerHTML=f}}break;default:f=b[c];h.innerHTML=f;break}}}function OnClickDelete(b,a){var d=OBJ("pro_list");var e=d.getElementsByTagName("tr");for(var g=1;g<=e.length;g++){if(e[g]!=null){if(e[g].id=="pro_no_"+b){d.deleteRow(g)}}}var c=HNAP.GetXML("SetInternetProfileAlpha");c.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/DeleteProfile",a);var f=HNAP.SetXML("SetInternetProfileAlpha",c);document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("wait_setting_finish").style.display="inline";setTimeout("window.location.reload()",1000)}function getElementsByName(a,f){var e=document.getElementsByTagName(a);var c=0;var d=[];for(var b=0;b<e.length;b++){if(e[b].getAttribute("name")==f){d[c++]=e[b]}}return d}var activepro="";function isProfileReadyToChoose(b){b=b+1;var e="GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+b;var f=xml_GetProInfo.Get(e+"/ProfileType");switch(f){case"DHCP":return true;case"STATIC":var d=xml_GetProInfo.Get(e+"/IPAddress");var h=xml_GetProInfo.Get(e+"/SubnetMask");var j=xml_GetProInfo.Get(e+"/Gateway");var c=xml_GetProInfo.Get(e+"/DNS/Primary");if(d==""||h==""||j==""||c==""){return false}else{return true}case"PPPoE":var a=xml_GetProInfo.Get(e+"/UserName");var g=xml_GetProInfo.Get(e+"/Password");if(a==""||g==""){return false}else{return true}case"WISP":return true;case"USB3G":return true;default:return true}}var selectedProfileType="";function OnClickRadio(b,d){var f="pro-"+b;var e=getElementsByName("span","pro_checkbox");activepro=d;for(var c=0;c<e.length;c++){var a=e[c].getAttribute("id");if(a==f){if(isProfileReadyToChoose(c)){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("check_connect_msg").style.display="inline";OBJ(a).innerHTML='<img src="image/checkBox_o.png" width="26" height="27">';selectedProfileType=e[c].getAttribute("pro_type")}else{document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("profile_is_not_configured").style.display="inline";OBJ(a).innerHTML='<img src="image/checkBox_o.png" width="26" height="27">'}}else{OBJ(a).innerHTML='<img src="image/checkBox_c.png" width="26" height="27">'}}}function OnClickOK(){var b=HNAP.GetXML("SetInternetProfileAlpha");b.Set("SetInternetProfileAlpha/InternetProfileLists/InternetProfile/ActiveProfile",activepro);var c=HNAP.SetXML("SetInternetProfileAlpha",b);var a=c.Get("SetInternetProfileAlphaResponse/SetInternetProfileAlphaResult");if(a=="OK"){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("check_connect_msg").style.display="none";document.getElementById("take_effect_msg").style.display="inline";document.getElementById("no_interface_msg").style.display="none";document.getElementById("connection_failed_msg").style.display="none";if(selectedProfileType=="WISP"){setTimeout("GetInternetConnectionStatus()",30*1000)}else{if(selectedProfileType=="USB3G"){setTimeout("GetInternetConnectionStatus()",30*1000)}else{setTimeout("GetInternetConnectionStatus()",10*1000)}}}else{if(a=="INFNOTFOUND"){document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("check_connect_msg").style.display="none";document.getElementById("take_effect_msg").style.display="none";document.getElementById("no_interface_msg").style.display="inline";document.getElementById("connection_failed_msg").style.display="none"}}}var GetStatusResult="0";var GetStatusCount=0;var Time_GetInternetConnectionStatus;var GetStatusRestart=0;function GetInternetConnectionStatus(){if(GetStatusResult=="0"){var a=HNAP.GetXML("GetCurrentInternetStatus",new Array("InternetStatus","true"));var b=a.Get("GetCurrentInternetStatusResponse/GetCurrentInternetStatusResult");GetStatusResult="1"}else{var a=HNAP.GetXML("GetCurrentInternetStatus",new Array("InternetStatus","false"));var b=a.Get("GetCurrentInternetStatusResponse/GetCurrentInternetStatusResult");GetStatusCount++}switch(b){case"OK_DETECTING_2":if(GetStatusCount==5&&GetStatusRestart<2){GetStatusCount=0;GetStatusResult="0";GetStatusRestart++}if(GetStatusCount<=10){Time_GetInternetConnectionStatus=window.clearInterval(Time_GetInternetConnectionStatus);Time_GetInternetConnectionStatus=self.setInterval("GetInternetConnectionStatus()",3000)}break;case"OK_CONNECTED":window.location.reload();break;case"OK_NOTCONNECTED":Time_GetInternetConnectionStatus=window.clearInterval(Time_GetInternetConnectionStatus);document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("check_connect_msg").style.display="none";document.getElementById("take_effect_msg").style.display="none";document.getElementById("no_interface_msg").style.display="none";document.getElementById("internet_connect_failed").style.display="inline";break;case"ERROR":Time_GetInternetConnectionStatus=window.clearInterval(Time_GetInternetConnectionStatus);document.getElementById("CreatePopAlertMessage").style.display="inline";document.getElementById("check_connect_msg").style.display="none";document.getElementById("take_effect_msg").style.display="none";document.getElementById("no_interface_msg").style.display="none";document.getElementById("connection_failed_msg").style.display="inline";break}}function InitProInfo(){total_pro=xml_GetProInfo.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile#");var b=xml_GetProInfo.Get("GetInternetProfileAlphaResponse/ActiveProfile");var c=0;for(var e=1;e<=total_pro;e++){var g=xml_GetProInfo.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+e+"/ProfileName");var a=xml_GetProInfo.Get("GetInternetProfileAlphaResponse/InternetProfileLists/InternetProfile:"+e+"/ProfileType");var f='&nbsp;<span name="pro_checkbox" id="pro-'+e+'" pro_type="'+a+'" onclick="OnClickRadio('+i+',\''+pro_name+'\');" style="cursor:pointer"><img src="image/checkBox_c.png" width="26" height="27"></span>';if(a=="STATIC"){a="Static IP"}else{if(a=="PPPoE"){a="xDSL Broadband (PPPoE)"}else{if(a=="WISP"){a="Hotspot"}else{if(a=="USB3G"){a="3G/4G Network"}}}}var j='<a href="Internet_ProAdd.html?method=edit&profile='+g+'"><img border="0" src="image/edit_btn.gif" width="28"/></a>';var k=null;if(a=="DHCP"||a=="Static IP"||a=="xDSL Broadband (PPPoE)"){k="-"}else{k='<img src="image/trash.gif" width="41" onclick="OnClickDelete('+i+',\''+pro_name+'\');" style="cursor:pointer"/>'}if(b==g){f='&nbsp;<span name="pro_checkbox" id="pro-'+e+'" onclick="OnClickRadio('+i+',\''+pro_name+'\');" style="cursor:pointer"><img src="image/checkBox_o.png" width="26" height="27"></span>'}g=f+" "+g;var d=[g,a,j,k];var h=["img","text","img","img"];InjectTable("pro_list","pro_no_"+e,d,h)}};</script> <style>.pro_table{position:relative;top:20px;width:900px;color:#56583f;margin:0 0 15px 0;font-size:14px;border:1px solid #4496a8;margin:0;padding:0}.pro_table th{color:#fff;background:#4496a8;height:30px}.pro_table td{height:47px}.pro_table td img{vertical-align:middle}</style> </head> <body> <div id="wrapper"> <div id="header"></div> <div id="menu"></div> <div id="content"> <div id="info"> <div id="FunctionName"><script>I18N("h","Internet Profiles");</script></div> <div id="wallimage"><img src="image/internet_page.png" alt="" width="195" height="119"/></div> <div id="directions"> <script>I18N("h","Internet Profiles are networks you want the device to remember and reconnect to in the future. Profiles are created automatically the first time you connect to a particular network, and some profiles may require additional information from your Internet service provider.");</script> </div> </div> <div id="funcBar"> <div id="pagePath">&nbsp;<script>I18N("h","Settings");</script> >> <script>I18N("h","Internet Profiles");</script></div> </div> <div id="main"> <table cellspacing="0" cellpadding="0" width="900" align="center" border="0"> <tbody> <tr> <td>&nbsp;</td> </tr> <tr> <td class="title" width="85%" valign="top">Profile List:</td> <td width="15%" class="save" align="center" onclick=""> <a href="Internet_ProAdd.html?method=add" style="text-decoration:none;"><span class="styled_button_s"><b><script>I18N("h","Add Profile");</script></b></span></a> </td> </tr> </tbody> </table> <table id="pro_list" class="pro_table" width="100%" cellspacing="0" cellpadding="3" border="0"> <tr> <th width="270"><script>I18N("h","Profile Name");</script></th> <th width="540"><script>I18N("h","Type");</script></th> <th width="50"><script>I18N("h","Edit");</script></th> <th width="40"><script>I18N("h","Delete");</script></th> </tr> </table> </div> </div> <div id="DetectRouterConnection" style="display:none"></div> <div id="footer"> <div id="copyright"><script>I18N("h","COPYRIGHT");</script></div> </div> </div> <div id="CreatePopAlertMessage" style="display:none"> <div id="AlertPopRect"> <div id="AlertPopBody"> <table class="myAlertPop_table_b" id="wait_setting_finish" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td><center><div id="Loading_pop_image2"></div></center></td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your changes are being saved.");</script></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="check_connect_msg" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td colspan="2"> <div id="Information_pop_image"></div> </td> </tr> <tr> <td colspan="2"> <div id="dialog_msg_black"><script>I18N("h","Are you sure you want to change your Internet connection type?");</script></div> </td> </tr> <tr> <td> <div id="Confirm_btn" onclick="OnClickOK()" style="cursor:pointer"><script>I18N("h","OK");</script></div> </td> <td> <div id="Confirm_btn" onclick="window.location.reload()" style="cursor:pointer"><script>I18N("h","Cancel");</script></div> </td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="take_effect_msg" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td><center><div id="Loading_pop_image2"></div></center></td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Your setting would be take effect.");</script></td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="no_interface_msg" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td colspan="2"> <center><div id="Warning_pop_image"></div></center> </td> </tr> <tr> <td colspan="2"> <div id="dialog_msg_black"><script>I18N("h","Interface is not ready, please check again.");</script></div> </td> </tr> <tr> <td> <div id="Confirm_btn" onclick="OnClickOK()" style="cursor:pointer"><script>I18N("h","OK");</script></div> </td> <td> <div id="Confirm_btn" onclick="window.location.reload()" style="cursor:pointer"><script>I18N("h","Cancel");</script></div> </td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="connection_failed_msg" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td><center><div id="Warning_pop_image"></div></center></td> </tr> <tr> <td label id="reciprocal_Number"></label></td> </tr> <tr> <td id="dialog_msg_black2"><script>I18N("h","Fail.");</script></td> </tr> <tr> <td> <center><div id="Confirm_btn" onclick="window.location.reload()" style="cursor:pointer"><script>I18N("h","Cancel");</script></div></center> </td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="profile_is_not_configured" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td colspan="2"> <center><div id="Warning_pop_image"></div></center> </td> </tr> <tr> <td colspan="2"> <div id="dialog_msg_black"><script>I18N("h","The selected profile is not configured.");</script></div> </td> </tr> <tr> <td> <center><div id="Confirm_btn" onclick="window.location.reload()" style="cursor:pointer"><script>I18N("h","OK");</script></div></center> </td> </tr> </tbody> </table> <table class="myAlertPop_table_b" id="internet_connect_failed" border="0" cellspacing="0" style="display:none"> <tbody> <tr> <td colspan="2"> <center><div id="Warning_pop_image"></div></center> </td> </tr> <tr> <td colspan="2"> <div id="dialog_msg_black"><script>I18N("h","The selected profile does not connect to Internet. Please recheck the configuration of the profile.");</script></div> </td> </tr> <tr> <td> <center><div id="Confirm_btn" onclick="window.location.reload()" style="cursor:pointer"><script>I18N("h","OK");</script></div></center> </td> </tr> </tbody> </table> </div> </div> </body> <script>Load_HTML();Initial();InitProInfo();checkTimeout();setMenu("menu_Settings");</script> </html>