function XmlDocument(a){this.XDoc=a;this.AnchorNode=null}XmlDocument.prototype={Serialize:function(){var a;if(window.ActiveXObject){a=this.XDoc.xml}else{a=(new XMLSerializer()).serializeToString(this.XDoc)}return a},dbgdump:function(){var a=window.open();a.document.open("content-type: text/xml");a.document.write(this.Serialize())},Find:function(n,g){var b=this.XDoc;var d=n.split("/");var f,e;var h,k;if(this.AnchorNode&&d[0]!=""){b=this.AnchorNode}else{b=this.XDoc}for(f=0;f<d.length;f+=1){if(d[f]==""){continue}if(d[f].indexOf(":")<0){h=d[f];k=1}else{var m=d[f].split(":");h=m[0];k=m[1]}var c=0;var l=0;var a;for(e=0;e<b.childNodes.length;e+=1){if(b.childNodes[e].nodeName==h){c+=1;if(k==c){b=b.childNodes[e];l+=1;break}}}if(l){continue}if(!g){return null}for(e=0;e<(k-c);e+=1){a=this.XDoc.createElement(h);b.appendChild(a)}b=a}return b},Anchor:function(b){var a=this.AnchorNode;if(b&&b!==""){this.AnchorNode=this.Find(b,false)}return a},AnchorPop:function(a){this.AnchorNode=a},GetDOMNodeValue:function(a){if(a.hasChildNodes()){return a.firstChild.nodeValue}return""},GetDOMNodeAttr:function(b,a){if(b.hasChildNodes()){if(b.firstChild.nodeType==1){return b.firstChild.getAttribute(a)}else{return b.getAttribute(a)}}return""},SetDOMNodeValue:function(b,c){if(b.hasChildNodes()){b.firstChild.nodeValue=c}else{var a=this.XDoc.createTextNode(c);b.appendChild(a)}},SetDOMNodeAttr:function(b,a,c){if(b.hasChildNodes()){if(b.firstChild.nodeType==1){b.firstChild.setAttribute(a,c)}else{b.setAttribute(a,c)}}},Del:function(c){var a=this.Find(c);if(a==null){return false}var b=a.parentNode;b.removeChild(a);return true},Get:function(f){var b=f.split("/")[f.split("/").length-1];var h=false;if(b=="Password"||b=="IPv6_PppoePassword"||b=="Key"||b=="AdminPassword"||b=="AccountPassword"||b=="RadiusSecret1"||b=="RadiusSecret2"||b=="MK"||b=="PSK"){h=true}var d;if(f.indexOf("#")<0){d=this.Find(f,false);if(d){if(h){return AES_Decrypt128(this.GetDOMNodeValue(d))}return this.GetDOMNodeValue(d)}return""}var c=0;var e=f.split("#");d=this.Find(e[0]);if(d){var g=d.nodeName;d=d.parentNode;for(var a=0;a<d.childNodes.length;a+=1){if(d.childNodes[a].nodeName==g){c+=1}}}return c},GetAttr:function(c,a){var b;if(c.indexOf("#")<0){b=this.Find(c,false);if(b){return this.GetDOMNodeAttr(b,a)}}return""},Set:function(d,c){var a=d.split("/")[d.split("/").length-1];if(a=="Password"||a=="IPv6_PppoePassword"||a=="Key"||a=="AdminPassword"||a=="AccountPassword"||a=="RadiusSecret1"||a=="RadiusSecret2"||a=="MK"||a=="PSK"){c=AES_Encrypt128(c)}var b=this.Find(d,true);if(b==null){alert("BUG(Set): this should not happen !!");return null}if(c==null){c=""}this.SetDOMNodeValue(b,c);return b},SetAttr:function(d,a,c){var b=this.Find(d,true);if(b==null){alert("BUG(SetAttr): this should not happen !!");return null}this.SetDOMNodeAttr(b,a,c);return b},Add:function(e,d){var a=this.Find(e,false);if(a==null){a=this.Find(e,true);this.SetDOMNodeValue(a,d);return a}var c=a.parentNode;var b=this.XDoc.createElement(a.nodeName);this.SetDOMNodeValue(b,d);c.appendChild(b);return b},GetPathByTarget:function(l,c,h,m,f){var e,d;var g,k,a;var o=false;var n=0;g=this.Find(l,f);if(g==null){return null}for(e=0;e<g.childNodes.length&&!o;e+=1){if(g.childNodes[e].nodeName==c){n+=1;k=g.childNodes[e];for(d=0;d<k.childNodes.length;d+=1){if(k.childNodes[d].nodeName==h){a=k.childNodes[d];if(this.GetDOMNodeValue(a)==m){o+=1}break}}if(o){return l+"/"+c+":"+n}}}if(f){n+=1;var b=l+"/"+c+":"+n+"/"+h;this.Set(b,m);return l+"/"+c+":"+n}return null}};function HTTPClient(){}HTTPClient.prototype={debug:false,__httpRequest:null,requestMethod:"POST",requestAsyn:true,returnXml:true,__header:null,onSend:null,onCallback:null,onError:function(a){if(!a){throw (a)}},__callback:function(){if(!this.__httpRequest){this.onError("Error : Request return error("+this.__httpRequest.status+").")}else{if(this.__httpRequest.readyState==2){if(this.onSend){this.onSend()}}else{if(this.__httpRequest.readyState==4){if(this.__httpRequest.status==200){if(this.onCallback){if(this.returnXml){var a=new XmlDocument(this.__httpRequest.responseXML);if(a!=null){if(this.debug){a.dbgdump()}this.onCallback(a)}else{this.onError("Error : unable to create XmlDocument().")}}else{this.onCallback(this.__httpRequest.responseText)}}}else{this.onError("Error : Request return error("+this.__httpRequest.status+").")}}}}},createRequest:function(){try{this.__httpRequest=new XMLHttpRequest()}catch(c){var d=new Array("MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP");var b=false;for(var a=0;a<d.length&&b==false;a+=1){try{this.__httpRequest=new ActiveXObject(d[a]);b=true}catch(c){}if(!b){this.onError("Browser do not support Ajax.")}}}},sendRequest:function(d,f){if(!this.__httpRequest){this.createRequest()}var a=this;this.__httpRequest.onreadystatechange=function(){a.__callback()};if(!d){this.onError("Error : Invalid request URL.");return}if(/iPhone/.test(navigator.userAgent)||/iPad/.test(navigator.userAgent)||/iPod/.test(navigator.userAgent)){var e=new Date().getTime();var b=d.indexOf("?");if(b!=-1){d+="&dummy="+e}else{d+="?dummy="+e}}this.__httpRequest.open(this.requestMethod,d,this.requestAsyn);if(this.__header){for(var c=0;c<this.__header.length;c+=1){if(this.__header[c].value!=""){this.__httpRequest.setRequestHeader(this.__header[c].name,this.__header[c].value)}}}if(this.requestMethod=="GET"||this.requestMethod=="get"){this.__httpRequest.send(null)}else{if(!f){this.onError("Error : Invalid payload for POST.");return}this.__httpRequest.send(f)}},getResponseHeader:function(a){if(!a){this.onError("Error : You must assign a header name to get.");return""}if(!this.__httpRequest){this.onError("Error : The HTTP request object is not exist.");return""}return this.__httpRequest.getResponseHeader(a)},getAllResponseHeaders:function(){if(this.__httpRequest){return this.__httpRequest.getAllResponseHeaders()}else{this.onError("Error : The HTTP request object is not exist.")}},setHeader:function(c,b){if(c&&b){if(!this.__header){this.__header=new Array()}var a=new Object();a.name=c;a.value=b;this.__header[this.__header.length]=a}},clearHeader:function(b){if(!this.__header){return}if(!b){return}for(var a=0;a<this.__header.length;a+=1){if(this.__header[a].name==b){this.__header.value="";return}}},clearAllHeaders:function(){if(!this.__header){return}this.__header=null},release:function(){this.__httpRequest=null;this.requestMethod="POST";this.requestAsyn=true;this.returnXml=true;this.__header=null;this.onCallback=null;this.onSend=null}};function GetAjaxObj(b){var c=0;var d=new Array();var a=d.length;if(a>0){for(c=0;c<a;c+=1){if(d[c][0]==b){return d[c][1]}}}d[a]=new Array();d[a][0]=b;d[a][1]=new HTTPClient();return d[a][1]};