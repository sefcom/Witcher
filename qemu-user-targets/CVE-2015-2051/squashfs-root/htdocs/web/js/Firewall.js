function Datalist(){this.list=new Array();this.maxrowid=0}Datalist.prototype.getData=function(b){var a;var c;for(a=0;a<this.list.length;a++){c=this.list[a];if(c.rowid==b){break}}return c};Datalist.prototype.getRowNum=function(a){var b=0;for(b=0;b<this.list.length;b++){if(a==this.list[b].rowid){break}}return b};Datalist.prototype.editData=function(c,a){var b=this.getRowNum(c);if(this.checkData(a,b)==false){return false}a.setRowid(c);this.list.splice(b,1,a);a.setDataToRow($("#tr"+a.rowid));return true};Datalist.prototype.deleteData=function(b){var a=this.getRowNum(b);this.list.splice(a,1);$("#tr"+b).remove()};Datalist.prototype.push=function(a){if(this.checkData(a,null)==false){return false}a.setRowid(this.maxrowid);this.list.push(a);this.maxrowid++;a.addRowToHTML("tblFirewall");return true};Datalist.prototype.checkData=function(b,c){var a;for(a=0;a<this.list.length;a++){if(a==c){continue}if(this.list[a].name==b.name){alert(I18N("j","Name cannot be the same."));return false}if((this.list[a].srcInterface==b.srcInterface)&&(this.list[a].srcIPstart==b.srcIPstart)&&(this.list[a].srcIPend==b.srcIPend)&&(this.list[a].dstInterface==b.dstInterface)&&(this.list[a].dstIPstart==b.dstIPstart)&&(this.list[a].dstIPend==b.dstIPend)&&(this.list[a].protocol==b.protocol)&&(this.list[a].portStart==b.portStart)&&(this.list[a].portEnd==b.portEnd)&&(this.list[a].schedule==b.schedule)){alert(I18N("j","Rule cannot be the same."));return false}}return true};Datalist.prototype.length=function(){return this.list.length};function Data(a,b,j,g,h,k,c,e){this.name=a;this.srcInterface=b;this.dstInterface=g;this.protocol=k;this.schedule=e;var f=this.parseRange(j);this.srcIPstart=f[0];this.srcIPend=f[1];var i=this.parseRange(h);this.dstIPstart=i[0];this.dstIPend=i[1];var d=this.parseRange(c);this.portStart=d[0];this.portEnd=d[1]}Data.prototype={rowid:null,name:null,srcInterface:null,srcIPstart:null,srcIPend:null,dstInterface:null,dstIPstart:null,dstIPend:null,protocol:null,portStart:null,portEnd:null,schedule:null,setRowid:function(a){this.rowid=a},parseRange:function(b){var a=new Array;a=b.split("-");if((a[0]==null)||(a[0]=="")){a[0]=a[1];a[1]=null}return a},showName:function(){return HTMLEncode(this.name)},showSchedule:function(){if((this.schedule=="Always")||(this.schedule=="")){return I18N("j","Always")}else{return HTMLEncode(this.schedule)}},addRowToHTML:function(c){var b;b="<tr id='tr"+this.rowid+"'></tr>";var a="#"+c+"> tbody";$(a).append(b);this.setDataToRow($("#tr"+this.rowid));return},setDataToRow:function(a){var b;b="<td>"+this.showName()+"</td>";b+="<td>"+this.showSchedule()+"</td>";b+="<td><img src='image/edit_btn.gif' width=28 height=28 style='cursor:pointer' onclick='editData("+this.rowid+")'/></td>";b+="<td><img src='image/trash.gif' width=41 height=41 style='cursor:pointer' onclick='deleteData("+this.rowid+")'/></td>";a.html(b);return},createRange:function(c,a){var b=c;if((a!="")&&(a!=null)){b+="-"+a}return b}};